<div class="findings-section">
  <mat-accordion [multi]="false">
    <mat-expansion-panel
      [expanded]="!collapsed"
      (opened)="collapsed = false"
      (closed)="collapsed = true"
      aria-label="Findings and Issues"
    >
      <mat-expansion-panel-header>
        <mat-panel-title>
          <ng-container *ngIf="!hideTitle">
            <mat-icon>find_in_page</mat-icon>
            <span>Findings & Issues</span>
          </ng-container>
        </mat-panel-title>
        <mat-panel-description>
          <span *ngIf="markdownLoading">Loading...</span>
          <span *ngIf="markdownError" class="error-text">Error loading content</span>
        </mat-panel-description>
      </mat-expansion-panel-header>

      <div class="markdown-content-wrapper">
        <div *ngIf="markdownLoading" class="loading-container">
          <mat-progress-spinner mode="indeterminate" diameter="24"></mat-progress-spinner>
        </div>

        <mat-card *ngIf="markdownError" class="error-card">
          <mat-card-content>
            <mat-icon color="warn">error</mat-icon>
            <span>{{ markdownError }}</span>
          </mat-card-content>
        </mat-card>

        <div *ngIf="markdownHtml && !markdownLoading && !markdownError" class="mat-typography" [innerHTML]="markdownHtml"></div>
      </div>
    </mat-expansion-panel>
  </mat-accordion>
</div>

